function showGrumbly(){if(!grumbly){grumbly=true;var e=$("#cover-content-holder");e.fadeIn("normal").animate({left:$(window).width()/2-e.width()/2,top:$(window).height()/2-e.height()/2})}}function animateHomeCover(){var e=$("#homepage-cover");var t=$("#cover-bottom-bar img");if(parseInt(e.css("marginTop"))==0){$("body").css("height",$(window).height());e.css({width:$(window).width(),height:$(window).height()});e.stop().animate({marginTop:-e.height()+48},2e3);t.stop().animate({marginTop:"10px"},2e3);t.rotate({angle:0,animateTo:180})}else{$("body").css("height","");e.css({width:$(window).width(),height:$(window).height()});e.stop().animate({marginTop:0},2e3);t.stop().animate({marginTop:"-42.5px"},2e3);t.rotate({angle:180,animateTo:0})}}function linkText(e){var t,n,r,i;n=/(\b(https?):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;replacedText=e.replace(n,'<a href="$1" target="_blank" class="colored-link-1" title="$1">$1</a>');r=/(^|[^\/])(www\.[\S]+(\b|$))/gim;replacedText=replacedText.replace(r,'$1<a href="http://$2" target="_blank" class="colored-link-1">$2</a>');return replacedText}function shortenLink(e){$.each($(e),function(){if(!$(this).hasClass("linked")){var e=$(this).text();e=e.replace(/(https?):\/\//,"");e=e.replace(/www\./,"");if(e.length>30){e=e.substring(0,27)+"..."}$(this).text(e)}})}function findLink(e){var t;t=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'\"\\.,<>?\u00AB\u00BB\u201C\u201D\u2018\u2019]))/i;if(e.match(t)){var n=RegExp.$1.length;if(n>30){return n-30}else{return 0}}else{return 0}}(function(e){for(var t,n=document.getElementsByTagName("head")[0].style,r=["transformProperty","WebkitTransform","OTransform","msTransform","MozTransform"],i=0;i<r.length;i++)void 0!==n[r[i]]&&(t=r[i]);var s="v"=="";jQuery.fn.extend({rotate:function(t){if(!(0===this.length||"undefined"==typeof t)){"number"==typeof t&&(t={angle:t});for(var n=[],r=0,i=this.length;r<i;r++){var s=this.get(r);if(!s.Wilq32||!s.Wilq32.PhotoEffect){var o=e.extend(!0,{},t),s=(new Wilq32.PhotoEffect(s,o))._rootObj;n.push(e(s))}else s.Wilq32.PhotoEffect._handleRotation(t)}return n}},getRotateAngle:function(){for(var e=[],t=0,n=this.length;t<n;t++){var r=this.get(t);r.Wilq32&&r.Wilq32.PhotoEffect&&(e[t]=r.Wilq32.PhotoEffect._angle)}return e},stopRotate:function(){for(var e=0,t=this.length;e<t;e++){var n=this.get(e);n.Wilq32&&n.Wilq32.PhotoEffect&&clearTimeout(n.Wilq32.PhotoEffect._timer)}}});Wilq32=window.Wilq32||{};Wilq32.PhotoEffect=function(){return t?function(e,t){e.Wilq32={PhotoEffect:this};this._img=this._rootObj=this._eventObj=e;this._handleRotation(t)}:function(e,t){this._img=e;this._rootObj=document.createElement("span");this._rootObj.style.display="inline-block";this._rootObj.Wilq32={PhotoEffect:this};e.parentNode.insertBefore(this._rootObj,e);if(e.complete)this._Loader(t);else{var n=this;jQuery(this._img).bind("load",function(){n._Loader(t)})}}}();Wilq32.PhotoEffect.prototype={_setupParameters:function(e){this._parameters=this._parameters||{};"number"!==typeof this._angle&&(this._angle=0);"number"===typeof e.angle&&(this._angle=e.angle);this._parameters.animateTo="number"===typeof e.animateTo?e.animateTo:this._angle;this._parameters.step=e.step||this._parameters.step||null;this._parameters.easing=e.easing||this._parameters.easing||function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n};this._parameters.duration=e.duration||this._parameters.duration||1e3;this._parameters.callback=e.callback||this._parameters.callback||function(){};e.bind&&e.bind!=this._parameters.bind&&this._BindEvents(e.bind)},_handleRotation:function(e){this._setupParameters(e);this._angle==this._parameters.animateTo?this._rotate(this._angle):this._animateStart()},_BindEvents:function(e){if(e&&this._eventObj){if(this._parameters.bind){var t=this._parameters.bind,n;for(n in t)t.hasOwnProperty(n)&&jQuery(this._eventObj).unbind(n,t[n])}this._parameters.bind=e;for(n in e)e.hasOwnProperty(n)&&jQuery(this._eventObj).bind(n,e[n])}},_Loader:function(){return s?function(e){var t=this._img.width,n=this._img.height;this._img.parentNode.removeChild(this._img);this._vimage=this.createVMLNode("image");this._vimage.src=this._img.src;this._vimage.style.height=n+"px";this._vimage.style.width=t+"px";this._vimage.style.position="absolute";this._vimage.style.top="0px";this._vimage.style.left="0px";this._container=this.createVMLNode("group");this._container.style.width=t;this._container.style.height=n;this._container.style.position="absolute";this._container.setAttribute("coordsize",t-1+","+(n-1));this._container.appendChild(this._vimage);this._rootObj.appendChild(this._container);this._rootObj.style.position="relative";this._rootObj.style.width=t+"px";this._rootObj.style.height=n+"px";this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._eventObj=this._rootObj;this._handleRotation(e)}:function(e){this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._width=this._img.width;this._height=this._img.height;this._widthHalf=this._width/2;this._heightHalf=this._height/2;var t=Math.sqrt(this._height*this._height+this._width*this._width);this._widthAdd=t-this._width;this._heightAdd=t-this._height;this._widthAddHalf=this._widthAdd/2;this._heightAddHalf=this._heightAdd/2;this._img.parentNode.removeChild(this._img);this._aspectW=(parseInt(this._img.style.width,10)||this._width)/this._img.width;this._aspectH=(parseInt(this._img.style.height,10)||this._height)/this._img.height;this._canvas=document.createElement("canvas");this._canvas.setAttribute("width",this._width);this._canvas.style.position="relative";this._canvas.style.left=-this._widthAddHalf+"px";this._canvas.style.top=-this._heightAddHalf+"px";this._canvas.Wilq32=this._rootObj.Wilq32;this._rootObj.appendChild(this._canvas);this._rootObj.style.width=this._width+"px";this._rootObj.style.height=this._height+"px";this._eventObj=this._canvas;this._cnv=this._canvas.getContext("2d");this._handleRotation(e)}}(),_animateStart:function(){this._timer&&clearTimeout(this._timer);this._animateStartTime=+(new Date);this._animateStartAngle=this._angle;this._animate()},_animate:function(){var e=+(new Date),t=e-this._animateStartTime>this._parameters.duration;if(t&&!this._parameters.animatedGif)clearTimeout(this._timer);else{(this._canvas||this._vimage||this._img)&&this._rotate(~~(10*this._parameters.easing(0,e-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration))/10);this._parameters.step&&this._parameters.step(this._angle);var n=this;this._timer=setTimeout(function(){n._animate.call(n)},10)}this._parameters.callback&&t&&(this._angle=this._parameters.animateTo,this._rotate(this._angle),this._parameters.callback.call(this._rootObj))},_rotate:function(){var e=Math.PI/180;return s?function(e){this._angle=e;this._container.style.rotation=e%360+"deg"}:t?function(e){this._angle=e;this._img.style[t]="rotate("+e%360+"deg)"}:function(t){this._angle=t;t=t%360*e;this._canvas.width=this._width+this._widthAdd;this._canvas.height=this._height+this._heightAdd;this._cnv.translate(this._widthAddHalf,this._heightAddHalf);this._cnv.translate(this._widthHalf,this._heightHalf);this._cnv.rotate(t);this._cnv.translate(-this._widthHalf,-this._heightHalf);this._cnv.scale(this._aspectW,this._aspectH);this._cnv.drawImage(this._img,0,0)}}()};s&&(Wilq32.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{return!document.namespaces.rvml&&document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<rvml:"+e+' class="rvml">')}}catch(e){return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}}())})(jQuery);$(document).ready(function(){$("#nav-category").click(function(){if($("#sub-nav").is(":visible")){$("#sub-nav").fadeOut(50)}else{$("#sub-nav").fadeIn(100)}$("#dropdown-sub-nav").fadeOut(50);$("#dropdown-form-login").fadeOut(50);$("#notification-dropdown").fadeOut(50)});$(".dropdown-shortlink").mousedown(function(){var e=$(this);var t=$("#dropdown-sub-nav");var n=$("#dropdown-form-login");if(t.length>0){if(t.is(":visible")){t.fadeOut(50)}else{t.fadeIn(100,function(){$("#email").focus()})}}else if(n.length>0){if(n.is(":visible")){n.fadeOut(50)}else{n.fadeIn(100,function(){$("#email").focus()})}}$("#notification-dropdown").fadeOut(50);$("#sub-nav").fadeOut(50)});$(".social-login .grumble-login").click(function(e){e.preventDefault();$($(this).parents("li").find(".hidden ul li")).insertAfter($(this).parents("li").find("li:first"));$(this).parent().remove();$("#email").focus()});$("#notification-number").mousedown(function(){if($("#notification-dropdown").is(":visible")){$("#notification-dropdown").fadeOut(50);$("#notification-dropdown li a").removeClass("highlight");$("#notification-number").attr("src","/images/icons/notification-none.png");$("#notification-header").html("Notifications (0 new)")}else{$("#notification-dropdown").fadeIn(100);var e=0;$("#notification-dropdown li a").each(function(){if($(this).hasClass("highlight")){e++}});if(e!=0){$.post("/php/notifications.php",{action:"markasread"})}}$("#dropdown-sub-nav").fadeOut(50);$("#dropdown-form-login").fadeOut(50);$("#sub-nav").fadeOut(50)});$("#notification-load a").click(function(e){e.preventDefault();var t=$(".ind-notification:last").attr("data-id");$.post("/php/notifications.php",{lastid:t,action:"load"},function(e){if(e!=""&&e!=0){$(e).insertAfter(".ind-notification:last")}else if(e==0){toastr.warning("No more notifications to load.");$("#notification-load").remove()}else{toastr.error("Could not load.")}})});$("#maincolumn").click(function(){$(".dropdown").fadeOut(50)});$("#category-header").mouseover(function(){$("#grumble-delete").show()}).mouseleave(function(){$("#grumble-delete").hide()});$("body").on("mouseover",".ind-reply",function(){$(this).find(".reply-delete").show()}).on("mouseleave",".ind-reply",function(){$(this).find(".reply-delete").hide()});$("body").on("click",".reply-delete",function(){if(confirm("Are you sure you want to delete this reply? **It cannot be undone**")){var e=$(this).attr("data-id");var t=$(this).parents(".ind-reply");$.post("/php/repliesajax.php",{id:e,action:"Delete"},function(e){if(e==1){toastr.success("Reply deleted.");t.remove()}else{toastr.error("Something went wrong. Could not delete.")}})}});$("#grumble-delete").click(function(){if(confirm("Are you sure you want to delete this Grumble? **All comments and replies will be deleted also**")){var e=$(this).attr("data-id");$.post("/php/transact-grumble.php",{id:e,action:"Delete"},function(e){if(e==1){toastr.success("Grumble deleted. Redirecting...");setTimeout(function(){window.location="http://"+window.location.hostname},1e3)}else{toastr.error("Something went wrong. Could not delete.")}})}});$("div").on("mouseover",".comment-holder",function(){$(this).find(".comment-options").show()}).mouseout(function(){$(this).find(".comment-options").hide()});var e=240;$("body").on("click",".comment-options p",function(){var e=$(this);var t=e.parents(".comment-holder");if(e.text()=="Delete"){var n=t.find(".username").attr("data-id");if(confirm("Are you sure you want to delete this comment? **All votes and replies will be deleted also**")){t.find(".gif-loader-replies").show();$.post("/php/commentajax.php",{commentid:n,action:"Delete"},function(n){t.find(".gif-loader-replies").hide();if(n==1){toastr.success("Comment deleted.");e.parents(".comment-holder").remove()}else{toastr.error("Something went wrong. Could not delete.")}})}}else if(e.text()=="Spam"){var n=e.parents(".comment-holder").find(".username").attr("data-id");if(confirm("Are you sure you want to report this comment as spam?")){var r=e.parents(".comment-holder");r.find(".gif-loader-replies").show();e.remove();$.post("/php/commentajax.php",{commentid:n,action:"Spam"},function(e){r.find(".gif-loader-replies").hide();if(e==1){toastr.success("Comment reported as spam. Thank you.")}else{toastr.error("Something went wrong. Could not report.")}})}}else if(e.text()=="Remove"){var n=e.parents(".comment-holder").find(".username").attr("data-id");if(confirm("Are you sure you want to remove this comment from the spam list?")){var r=e.parents(".comment-holder");r.find(".gif-loader-replies").show();$.post("/php/commentajax.php",{commentid:n,action:"Remove"},function(t){r.find(".gif-loader-replies").hide();if(t==1){toastr.success("Removed from spam list.");e.closest(".spam-holder").remove();r.remove()}else{toastr.error("Something went wrong. Could not remove.")}})}}}).on("click",".votes-up a",function(e){e.preventDefault();var t=$(this).attr("data-id");var n=$(this).parent();$(this).remove();var r=parseInt(n.find(".votes-up-number").text());var i='Votes up<img src="/images/icons/thumb-up_1.jpg" alt="Vote up" width="14" height="14"/>(<span class="votes-up-number">'+r+"</span>)";n.html(i);n.parents(".comment-holder").find(".gif-loader-replies").show();$.post("/php/votes.php",{vote_up:t},function(e){n.parents(".comment-holder").find(".gif-loader-replies").hide();if(e==1){r=r+1;n.find(".votes-up-number").html(r)}})}).on("keyup",".quick-reply-input",function(){var n=$(this).val();t=findLink(n);if(t>0&&$("#link-present").is(":visible")==false){$(this).parent().find(".link-present").fadeIn(100)}else if(t==0){$(this).parent().find(".link-present").fadeOut(50)}e=240-n.length+t;if(e<=0){$(this).parent().find(".reply-character-count").html(e).css("color","red")}else{$(this).parent().find(".reply-character-count").html(e).css("color","green")}}).on("focusin",".quick-reply-input",function(){$(this).css("height","50px");$(this).parent().find(".reply-btn-holder").show()}).on("click","p.replies-view",function(){var e=$(this);var t=e.attr("data-id");var n=e.parents(".comment-holder");if(n.find(".replies").is(":visible")==false){if(e.attr("data-replies")==0){n.find(".replies").slideDown("fast");e.find("a").html("Close")}else if(n.find(".ind-reply").length>0){n.find(".replies").slideDown("fast");e.find("a").html("Close")}else{n.find(".gif-loader-replies").show();n.find(".view-all-replies").show();$.post("/php/repliesajax.php",{reply:t,type:"load",amount:"few"},function(t){n.find(".gif-loader-replies").hide();if(t!=""){$(t).insertBefore(n.find(".quick-reply-input"));n.find(".replies").slideDown("fast");e.find("a").html("Close");$(n.find(".reply-text")).each(function(){var e=linkText($(this).html());$(this).addClass("linked").html(e)});shortenLink(".reply-text a")}})}}else if(e.find("a").html()=="Close"){n.find(".replies").slideUp("fast");e.find("a").html(e.attr("data-html"))}}).on("click",".view-all-replies",function(){var e=$(this);var t=e.attr("data-id");e.parents(".comment-holder").find(".gif-loader-replies").show();$.post("/php/repliesajax.php",{reply:t,type:"load",amount:"all"},function(t){e.parents(".comment-holder").find(".gif-loader-replies").hide();if(t!=""){$(".ind-reply").remove();$(t).insertBefore(e.parents(".comment-holder").find(".quick-reply-input"));e.hide();$(e.parents(".comment-holder").find(".reply-text")).each(function(){var e=linkText($(this).html());$(this).addClass("linked").html(e)});shortenLink(".reply-text a")}})}).on("click",".quick-reply-button",function(){var t=$(this);var n=$(this).parents(".reply-padding").find(".quick-reply-input").val();var r=$(this).parents(".comment-holder");var i=r.find(".replies-view").attr("data-id");var s=r.find(".username:first").text();if(n==""||n.match(/^\s*$/)){toastr.warning("Reply cannot be empty.")}else if(e<0){toastr.warning("Too many characters to submit.")}else{r.find(".gif-loader-replies").show();t.attr("disabled","disabled");$.post("/php/repliesajax.php",{reply:i,type:"enter",text:n,statususername:s},function(e){r.find(".gif-loader-replies").hide();t.removeAttr("disabled");if(e!=""){$(e).insertBefore(r.find(".quick-reply-input"));var n=r.find(".ind-reply:last .reply-text");var i=linkText(n.html());n.addClass("linked").html(i);shortenLink(".ind-reply:last .reply-text a");r.find(".ind-reply:last").slideDown("fast");r.find(".quick-reply-input").val("");r.find(".reply-character-count").html("160");var s=parseInt(r.find(".replies-view").attr("data-replies"))+1;r.find(".replies-view").attr("data-replies",s);r.find(".replies-view span").html("("+s+")");r.find(".view-all-replies p").html("View All Replies ("+s+")");r.find(".reply-btn-holder").hide();r.find(".quick-reply-input").css("height","25px")}})}});$(".grumble-like-number").click(function(){var e=$(this);var t=$("#subcat-id").attr("data-id");if($(".user-inline .dropdown-login").length==1){$.post("/php/transact-grumble.php",{action:"voteup",subcatid:t},function(e){if(e==1){var t=parseInt($(".grumble-vote-font").text());t++;$(".grumble-vote-font").html(t)}else if(e==0||e==""){toastr.warning("You have already voted up.")}else{toastr.error("Something went wrong.")}})}else{toastr.warning("You must be logged in to vote.")}});var t=0;var n=0;$("#quick-compose-textarea").keypress(function(e){if(e.keyCode==13){e.preventDefault()}}).keyup(function(){var e=$(this).val();t=findLink(e);if(t>0&&$("#link-present").is(":visible")==false){$("#link-present").fadeIn(100)}else if(t==0){$("#link-present").fadeOut(50)}n=600-e.length+t;if(n<=0){$(this).parent().find("#character-count").html(n).css("color","red")}else{$(this).parent().find("#character-count").html(n).css("color","green")}}).focusin(function(){$(this).css({height:"75px","background-color":"white"});$("#grumble-comment div").show()});$("#quick-description-grumblename").keyup(function(){var e=$(this).val();var t=40-e.length;if(t<=0){$(this).parent().find("#character-count").html(t).css("color","red")}else{$(this).parent().find("#character-count").html(t).css("color","green")}}).focusin(function(){var e=$(this).val();var t=40-e.length;if(t<=0){$(this).parent().find("#character-count").html(t).css("color","red")}else{$(this).parent().find("#character-count").html(t).css("color","green")}});var r;$("#quick-description-textarea").keypress(function(e){if(e.keyCode==13){e.preventDefault()}}).on("keyup",function(){var e=$(this).val();t=findLink(e);if(t>0&&$("#link-present").is(":visible")==false){$("#link-present").fadeIn(100)}else if(t==0){$("#link-present").fadeOut(50)}r=500-e.length+t;if(r<=0){$(this).parent().find("#character-count").html(r).css("color","red")}else{$(this).parent().find("#character-count").html(r).css("color","green")}}).focusin(function(){var e=$(this).val();r=500-e.length+t;if(r<=0){$(this).parent().find("#character-count").html(r).css("color","red")}else{$(this).parent().find("#character-count").html(r).css("color","green")}});if($("#referrer").length>0){$("#referrer").val(window.location.pathname)}if($("#login-refer").length>0){$("#login-refer").val(".."+window.location.pathname);$(".social-login a").each(function(){if(!$(this).hasClass("grumble-login"))$(this).attr("href",$(this).attr("href")+"&redirect=.."+window.location.pathname)})}$("#quick-description-submit").click(function(e){if($("#quick-description-grumblename").val().length>40){e.preventDefault();toastr.warning("Too many characters in Grumble to submit.");$("#quick-description-grumblename").focus()}else if(r<0){e.preventDefault();toastr.warning("Too many characters in Grumble Description to submit.");$("#quick-description-textarea").focus()}else if($("#quick-description-grumblename").val().length==0||$("#quick-description-textarea").val().length==0||$("#quick-description-grumblename").val().match(/^\s*$/)||$("#quick-description-textarea").val().match(/^\s*$/)){e.preventDefault();toastr.warning("Grumble name/description cannot be empty.")}else if($("#grumble-dropdown").val()==0){e.preventDefault();toastr.warning("A category must be selected.")}});$("#open-quick-compose").mousedown(function(){$("#lightbox-container").fadeIn(100);$("#comment-status-lightbox").fadeIn(100,function(){$("#quick-compose-textarea").focus()});$("#lightbox-container").click(function(){$("#lightbox-container").fadeOut(50);$("#comment-status-lightbox").fadeOut(50)});$(".close-quick-submit").click(function(){$("#lightbox-container").fadeOut(50);$("#comment-status-lightbox").fadeOut(50)})});$(".submit-login").click(function(e){if($("#email").val()==""||$("#password").val()==""){e.preventDefault()}});var i=true;var s=false;var o=false;var u=false;var a=false;$(".button").mousedown(function(e){if($(this).val()=="View More"&&i){i=false;var t=$(".tabs a.active:first");if($("#cat-header h1").length>0)var n=$("#cat-header h1").attr("data-id");if($(".user-name").length>0)var r=$(".user-name").attr("data-id");var f="";var l=0;if(t.text()=="Top Grumbles"){f="top";l=$("#tab1 .grumble-holder").length}else if(t.text()=="Recent Grumbles"){f="recent";l=$("#tab2 .grumble-holder:last").find(".grumble-text-holder a").attr("data-id")}else if(t.text()=="Top Comments"){f="top-comment";l=$("#tab3 .comment-holder").length}else if(t.text()=="Recent Comments"){f="recent-comment";l=$("#tab4 .comment-holder:last").find(".username").attr("data-id")}else if(t.text()=="Comments"){f="recent-comment";l=$("#tab1 .comment-holder:last").find(".username").attr("data-id")}else if(t.text()=="Grumbles"){f="recent";l=$("#tab2 .grumble-holder:last").find(".grumble-text-holder a").attr("data-id")}if(n!=undefined){$("#gif-loader").show();$.post("/php/categorygrab.php",{catID:n,type:f,last:l},function(e){$("#gif-loader").hide();i=true;if(e!="none"&&f=="top"){$(e).insertAfter($("#tab1 .grumble-holder:last"));$.each($(".grumble-description"),function(){if(!$(this).hasClass("linked")){var e=linkText($(this).html());$(this).addClass("linked").html(e)}});shortenLink(".grumble-description a")}else if(e!="none"&&f=="recent"){$(e).insertAfter($("#tab2 .grumble-holder:last"));$.each($(".grumble-description"),function(){if(!$(this).hasClass("linked")){var e=linkText($(this).html());$(this).addClass("linked").html(e)}});shortenLink(".grumble-description a")}else if(e=="none"&&f=="top"){o=="true";$(".view-more").slideUp("fast")}else if(e=="none"&&f=="recent"){s=="true";$(".view-more").slideUp("fast")}})}else if(r!=undefined){$("#gif-loader").show();if(f=="recent-comment"){$.post("/php/commentloadajax.php",{userID:r,type:f,last:l},function(e){$("#gif-loader").hide();i=true;if(e!="none"&&f=="recent-comment"){$(e).insertAfter($("#tab1 .comment-holder:last"))}else if(e=="none"&&f=="recent-comment"){u=="true";$(".view-more").slideUp("fast")}})}else if(f=="recent"){$("#gif-loader").show();$.post("/php/categorygrab.php",{userID:r,type:f,last:l},function(e){$("#gif-loader").hide();i=true;if(e!="none"&&f=="recent"){$(e).insertAfter($("#tab2 .grumble-holder:last"))}else if(e=="none"&&f=="recent"){s=="true";$(".view-more").slideUp("fast")}})}}else{$("#gif-loader").show();if(f=="top"||f=="recent"){$.post("/php/categorygrab.php",{type:f,last:l},function(e){i=true;$("#gif-loader").hide();if(e!="none"&&f=="top"){$(e).insertAfter($("#tab1 .grumble-holder:last"));$.each($(".grumble-description"),function(){if(!$(this).hasClass("linked")){var e=linkText($(this).html());$(this).addClass("linked").html(e)}});shortenLink(".grumble-description a")}else if(e!="none"&&f=="recent"){$(e).insertAfter($("#tab2 .grumble-holder:last"));$.each($(".grumble-description"),function(){if(!$(this).hasClass("linked")){var e=linkText($(this).html());$(this).addClass("linked").html(e)}});shortenLink(".grumble-description a")}else if(e=="none"&&f=="top"){o=="true";$(".view-more").slideUp("fast")}else if(e=="none"&&f=="recent"){s=="true";$(".view-more").slideUp("fast")}})}else if(f=="top-comment"||f=="recent-comment"){$.post("/php/commentloadajax.php",{type:f,last:l,location:"home"},function(e){$("#gif-loader").hide();i=true;if(e!="none"&&f=="top-comment"){$(e).insertAfter($("#tab3 .comment-holder:last"));$.each($(".comment-text"),function(){if(!$(this).hasClass("linked")){var e=linkText($(this).html());$(this).addClass("linked").html(e)}});shortenLink(".comment-text a")}else if(e!="none"&&f=="recent-comment"){$(e).insertAfter($("#tab4 .comment-holder:last"));$.each($(".comment-text"),function(){if(!$(this).hasClass("linked")){var e=linkText($(this).html());$(this).addClass("linked").html(e)}});shortenLink(".comment-text a")}else if(e=="none"&&f=="top-comment"){a=="true";$(".view-more").slideUp("fast")}else if(e=="none"&&f=="recent-comment"){u=="true";$(".view-more").slideUp("fast")}})}}}else if($(this).text()=="Settings"){$("#settings-holder").stop().animate({top:"46px"},"normal");$("#settings-background").stop().fadeIn("normal");$("#settings-background").click(function(){$("#settings-holder").stop().animate({top:"-500px"},"normal");$("#settings-background").stop().fadeOut("normal")})}else if($(this).text()=="Close"){$("#settings-holder").stop().animate({top:"-500px"},"normal");$("#settings-background").stop().fadeOut("normal")}});$("#grumble-comment-form").submit(function(e){var t=$(this);e.preventDefault();if(n<0){toastr.warning("Too many characters to submit.")}else if($("#quick-compose-textarea").val().length==0||$("#quick-compose-textarea").val().match(/^\s*$/)){toastr.warning("Comment cannot be empty.")}else{var r=$("#quick-compose-textarea").val();var i=$("#comment-category").val();$(t).find(".button").attr("disabled","disabled");$(t).find("#gif-loader-comment").show();$.post("/php/commentajax.php",{comment:r,category:i},function(e){$(t).find("#gif-loader-comment").hide();$(t).find(".button").removeAttr("disabled");if(e==0||e==""){toastr.error("Something went wrong. Please check your entries.")}else if(e==1){toastr.warning("Already submitted.")}else if(e!=""){if($(".comment-holder").length>0){$(e).insertBefore(".comment-holder:first");var n=linkText($(".comment-text:first").text());$(".comment-text:first").addClass("linked").html(n);shortenLink(".comment-text:first a")}else{$("<div id='comments-left-header'><h4>Comments</h4></div>").insertBefore("#grumble-comment");$(e).insertAfter("#grumble-comment");$("#comments-left .text-align-center").remove();var n=linkText($(".comment-text:first").text());$(".comment-text:first").addClass("linked").html(n);shortenLink(".comment-text:first a")}if($("#comments-left-header").length>0){var r=parseInt($("#comments-left-header span").text())+1;$("#comments-left-header span").html(r)}$("#quick-compose-textarea").val("").css({height:"20px","background-color":"#FFF9E8"});$("#grumble-comment div").hide()}})}});$("button").removeAttr("disabled");$(".new-grumble").mousedown(function(e){e.preventDefault();var t=$(window).height();if(t<450&&t>=360){$("#grumble-lightbox").css("top","50px")}else if(t<360){$("#grumble-lightbox").css("top","5px")}$("#lightbox-container").fadeIn(100);$("#grumble-lightbox").fadeIn(100,function(){$("#quick-description-grumblename").focus()});$("#lightbox-container").click(function(){$("#lightbox-container").fadeOut(50);$("#grumble-lightbox").fadeOut(50);$("#help-callout").fadeOut(50)});$(".close-quick-submit").click(function(){$("#lightbox-container").fadeOut(50);$("#grumble-lightbox").fadeOut(50);$("#help-callout").fadeOut(50)})});var f=true;var l=1;var c=0;var h=true;var p=$("#comments-filter").val();if($("#comments-left .comment-holder").length==10){$(window).scroll(function(){if($(window).scrollTop()>=$(document).height()-$(window).height()&&i){i=false;c=$("#subcat-id").attr("data-id");if(c==null){c=$.urlParam("id")}if(p=="recent")var e=$(".username:last").attr("data-id");else var e=$(".comment-holder").length;$("#gif-loader").fadeIn(50);$.post("/php/commentloadajax.php",{typescroll:p,pagenumber:l,number:10,subCat:c,lastid:e},function(e){$("#gif-loader").fadeOut(50);if(e=="none"){f=false;i=false;$("#load-more-grumbles").hide();toastr.warning("No more comments to load.")}else if(e!=""){i=true;f=true;l++;$(e).insertAfter($(".comment-holder:last"));$.each($(".comment-text"),function(){if(!$(this).hasClass("linked")){var e=linkText($(this).html());$(this).addClass("linked").html(e)}});shortenLink(".comment-text a")}})}});$("#load-more-grumbles").click(function(){if(i){i=false;c=$("#subcat-id").attr("data-id");if(c==null){c=$.urlParam("id")}if(p=="recent")var e=$(".username:last").attr("data-id");else var e=$(".comment-holder").length;$("#gif-loader").fadeIn(50);$.post("/php/commentloadajax.php",{typescroll:p,pagenumber:l,number:10,subCat:c,lastid:e},function(e){$("#gif-loader").fadeOut(50);if(e=="none"){f=false;i=false;$("#load-more-grumbles").hide();toastr.warning("No more comments to load.")}else if(e!=""){i=true;f=true;l++;$(e).insertAfter($(".comment-holder:last"));$.each($(".comment-text"),function(){if(!$(this).hasClass("linked")){var e=linkText($(this).html());$(this).addClass("linked").html(e)}});shortenLink(".comment-text a")}})}});$("#comments-filter").change(function(){var e=$(this).val();c=$("#subcat-id").attr("data-id");if(c==null){c=$.urlParam("id")}if(h&&e!=p){p=e;h=false;f=true;i=true;$(".comment-holder").remove();$("#gif-loader").show();$.post("/php/commentloadajax.php",{type:e,subCat:c},function(e){h=true;$("#gif-loader").hide();if(e!="none"&&e!=""){if($("#grumble-comment").length>0)$(e).insertAfter("#grumble-comment");else $(e).insertAfter("#comments-left-header")}else{toastr.error("No comments loaded.")}})}})}$("ul.tabs").each(function(){var e,t,n=$(this).find("a");e=$(this).find("a.active");t=$(e.attr("href"));n.each(function(){if($(this).attr("href")!=e.attr("href"))$($(this).attr("href")).hide()});var r=$(".tabs a.active").position();r=r.left+$(".tabs a.active").width()/2-$("#arrow-top img").width()/2;$("#arrow-top img").css("margin-left",r);$(this).on("click","a",function(n){if($("#tab2 .grumble-holder").length>=10&&$(this).html()=="Recent Grumbles"&&!s||$("#tab1 .grumble-holder").length>=10&&$(this).html()=="Top Grumbles"&&!o||$("#tab4 .comment-holder").length>=10&&$(this).html()=="Recent Comments"&&!u||$("#tab3 .comment-holder").length>=10&&$(this).html()=="Top Comments"&&!a||$("#tab2 .grumble-holder").length>=10&&$(this).html()=="Grumbles"&&!o||$("#tab1 .comment-holder").length>=10&&$(this).html()=="Comments"&&!u){$(".view-more").slideDown("fast")}else{$(".view-more").slideUp("fast")}var r=$(this).position();r=r.left+$(this).width()/2-$("#arrow-top img").width()/2;$("#arrow-top img").animate({marginLeft:r},"normal");e.removeClass("active");t.fadeOut("fast");e=$(this);t=$($(this).attr("href"));e.addClass("active");t.fadeIn("normal");n.preventDefault()})});if($("ul.tabs").length>0){$(window).resize(function(){var e=$(".tabs a.active").position();e=e.left+$(".tabs a.active").width()/2-$("#arrow-top img").width()/2;$("#arrow-top img").css("margin-left",e)})}$.urlParam=function(e){var t=null;var t=(new RegExp("[\\?&]"+e+"=([^&#]*)")).exec(window.location.href);if(t!=null){return t[1]||0}};if($.urlParam("login")==1){var d=$("#dropdown-form");$("#dropdown-form").fadeIn(100);d.parent().find(".login-drop-image").attr("src","images/arrow-down.png");$("#email").focus()}if($.urlParam("create")=="new"){$("#lightbox-container").fadeIn(100);$("#grumble-share").fadeIn(100);$("#lightbox-container").click(function(){$("#lightbox-container").fadeOut(50);$("#grumble-share").fadeOut(50)});$(".close-quick-submit").click(function(){$("#lightbox-container").fadeOut(50);$("#grumble-share").fadeOut(50)})}if($.urlParam("login")=="failed"){toastr.error("Incorrect email/password entered.")}$("#forg-submit").click(function(e){if($("#pass-forg").val()==""||$("#pass-forg2").val()==""){e.preventDefault();toastr.warning("Cannot leave a field blank.")}else if($("#pass-forg").val().length<=5){e.preventDefault();toastr.warning("Password has to be longer than 5 characters.")}else if($("#pass-forg").val()!=$("#pass-forg2").val()){e.preventDefault();toastr.warning("Passwords have to match.")}});$(".help-callout").click(function(e){$("#help-callout div").html("");var t=$(this).attr("data-id");var n=$(this).offset();$("#help-callout").css({left:n.left-18,top:n.top+25}).fadeIn(100);$("#help-callout").mouseleave(function(){$("#help-callout").fadeOut(50)});$("label").mouseenter(function(){$("#help-callout").fadeOut(50)});$.post("/php/helploadajax.php",{id:t},function(e){if(e!=""){$("#help-callout div").append(e)}else{$("#help-callout div").append("<p>No help found.</p>")}})});if($(".comment-text").length>0){$.each($(".comment-text"),function(){var e=linkText($(this).html());$(this).addClass("linked").html(e)});shortenLink(".comment-text a")}if($("#sub-category-desc").length>0){var v=linkText($("#sub-category-desc").html());$("#sub-category-desc").html(v);shortenLink("#sub-category-desc a")}if($(".grumble-description").length>0){$.each($(".grumble-description"),function(){var e=linkText($(this).html());$(this).addClass("linked").html(e)});shortenLink(".grumble-description a")}if($("#cover-bottom-bar").length>0){$("#grumble-monster-home img").load(function(){showGrumbly()});setTimeout(showGrumbly,1e3);$("body").css("height",$(window).height());$("#cover-bottom-bar img").click(function(){animateHomeCover()});$(window).resize(function(){var e=$("#cover-content-holder");var t=$("#homepage-cover");if(parseInt(t.css("marginTop"))==0){$("body").css("height",$(window).height());t.css({width:$(window).width(),height:$(window).height(),marginTop:0})}else{$("body").css("height","");t.css({width:$(window).width(),height:$(window).height(),marginTop:-t.height()+48})}e.css({left:$(window).width()/2-e.width()/2,top:$(window).height()/2-e.height()/2-20})});$(window).resize()}$("#social-icons img").hover(function(){$(this).rotate({angle:0,animateTo:360})})});var grumbly=false;(function(e,t){e.toastr=function(){var e={tapToDismiss:true,toastClass:"toast",containerId:"toast-container",debug:false,fadeIn:300,fadeOut:700,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-center",timeOut:3e3,titleClass:"toast-title",messageClass:"toast-message"},n=function(e,t){return o({iconClass:i().iconClasses.error,message:e,title:t})},r=function(e){var n=t("#"+e.containerId);if(n.length)return n;n=t("<div/>").attr("id",e.containerId).addClass(e.positionClass);n.appendTo(t("body"));return n},i=function(){return t.extend({},e,toastr.options)},s=function(e,t){return o({iconClass:i().iconClasses.info,message:e,title:t})},o=function(e){var n=i(),s=e.iconClass||n.iconClass,o=null,u=r(n),a=t("<div/>"),f=t("<div/>"),l=t("<div/>"),c={options:n,map:e};if(e.iconClass){a.addClass(n.toastClass).addClass(s)}if(e.title){f.append(e.title).addClass(n.titleClass);a.append(f)}if(e.message){l.append(e.message).addClass(n.messageClass);a.append(l)}var h=function(){if(t(":focus",a).length>0)return;var e=function(){return a.fadeOut(n.fadeOut)};t.when(e()).done(function(){if(a.is(":visible")){return}a.remove();if(u.children().length===0)u.remove()})};var p=function(){if(n.timeOut>0||n.extendedTimeOut>0){o=setTimeout(h,n.extendedTimeOut)}};var d=function(){clearTimeout(o);a.stop(true,true).fadeIn(n.fadeIn)};a.hide();u.prepend(a);a.fadeIn(n.fadeIn);if(n.timeOut>0){o=setTimeout(h,n.timeOut)}a.hover(d,p);if(!n.onclick&&n.tapToDismiss){a.click(h)}if(n.onclick){a.click(function(){n.onclick()&&h()})}if(n.debug){console.log(c)}return a},u=function(e,t){return o({iconClass:i().iconClasses.success,message:e,title:t})},a=function(e,t){return o({iconClass:i().iconClasses.warning,message:e,title:t})};return{error:n,info:s,options:{},success:u,warning:a}}()})(window,jQuery)